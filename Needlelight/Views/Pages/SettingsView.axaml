<views:View x:TypeArguments="viewModels:SettingsViewModel"
            xmlns="https://github.com/avaloniaui"
            xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            xmlns:views="clr-namespace:Needlelight.Views"
            xmlns:viewModels="clr-namespace:Needlelight.ViewModels"
            xmlns:ext="clr-namespace:Needlelight.Extensions"
            d:DesignHeight="800"
            d:DesignWidth="600"
            x:DataType="viewModels:SettingsViewModel"
            x:CompileBindings="True"
            x:Class="Needlelight.Views.Pages.SettingsView">

    <ScrollViewer>
        <StackPanel Margin="40" Spacing="32" MaxWidth="600" HorizontalAlignment="Center">

            <!-- Header -->
            <StackPanel Spacing="8" HorizontalAlignment="Center">
                <TextBlock Text="Settings"
                           FontFamily="{DynamicResource GameFont}"
                           FontSize="28"
                           FontWeight="Bold"
                           Foreground="{DynamicResource Brush.TextPrimary}"
                           HorizontalAlignment="Center"/>
                <TextBlock Text="Configure your Needlelight experience"
                           FontFamily="{DynamicResource UIFont}"
                           FontSize="14"
                           Foreground="{DynamicResource Brush.TextSecondary}"
                           HorizontalAlignment="Center"/>
            </StackPanel>

        <!-- General Settings -->
            <Border Classes="card">
                <StackPanel Spacing="24">
                    <TextBlock Text="General"
                               FontFamily="{DynamicResource UIFont}"
                               FontSize="18"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource Brush.TextPrimary}"/>

            <!-- Removed in favor of top bar game selector -->

                    <!-- Language -->
                    <Grid ColumnDefinitions="*,Auto">
                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock Text="Language"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontWeight="Medium"
                                       Foreground="{DynamicResource Brush.TextPrimary}"/>
                            <TextBlock Text="Select your preferred language"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontSize="12"
                                       Foreground="{DynamicResource Brush.TextSecondary}"/>
                        </StackPanel>
                        <ComboBox Grid.Column="1"
                                  MinWidth="150"
                                  VerticalAlignment="Center"
                                  ItemsSource="{Binding LanguageOptions}"
                                  SelectedItem="{Binding LanguageSelection}"/>
                    </Grid>

                    <!-- Low Storage Mode -->
                    <Grid ColumnDefinitions="*,Auto">
                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock Text="Low Storage Mode"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontWeight="Medium"
                                       Foreground="{DynamicResource Brush.TextPrimary}"/>
                            <TextBlock Text="Reduces disk space usage for mod downloads"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontSize="12"
                                       Foreground="{DynamicResource Brush.TextSecondary}"/>
                        </StackPanel>
                        <ToggleSwitch Grid.Column="1"
                                      VerticalAlignment="Center"
                                      IsChecked="{Binding LowStorageMode}"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Mod Management -->
            <Border Classes="card">
                <StackPanel Spacing="24">
                    <TextBlock Text="Mod Management"
                               FontFamily="{DynamicResource UIFont}"
                               FontSize="18"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource Brush.TextPrimary}"/>

                    <!-- Warn Before Removing Dependencies -->
                    <Grid ColumnDefinitions="*,Auto">
                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock Text="Dependency Warnings"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontWeight="Medium"
                                       Foreground="{DynamicResource Brush.TextPrimary}"/>
                            <TextBlock Text="Warn before removing mods that other mods depend on"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontSize="12"
                                       Foreground="{DynamicResource Brush.TextSecondary}"/>
                        </StackPanel>
                        <ToggleSwitch Grid.Column="1"
                                      VerticalAlignment="Center"
                                      IsChecked="{Binding WarnBeforeRemovingDependents}"/>
                    </Grid>

                    <!-- Auto Remove Dependencies -->
                    <Grid ColumnDefinitions="*,Auto">
                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock Text="Auto Remove Dependencies"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontWeight="Medium"
                                       Foreground="{DynamicResource Brush.TextPrimary}"/>
                            <TextBlock Text="Automatically handle unused dependencies"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontSize="12"
                                       Foreground="{DynamicResource Brush.TextSecondary}"/>
                        </StackPanel>
                        <ComboBox Grid.Column="1"
                                  MinWidth="110"
                                  VerticalAlignment="Center"
                                  ItemsSource="{Binding AutoRemoveDepsOptions}"
                                  SelectedItem="{Binding AutoRemoveDepSelection}"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Advanced Settings -->
            <Border Classes="card">
                <StackPanel Spacing="24">
                    <TextBlock Text="Advanced"
                               FontFamily="{DynamicResource UIFont}"
                               FontSize="18"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource Brush.TextPrimary}"/>

                    <!-- Custom Modlinks -->
                    <Grid ColumnDefinitions="*,Auto">
                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock Text="Custom Mod Links"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontWeight="Medium"
                                       Foreground="{DynamicResource Brush.TextPrimary}"/>
                            <TextBlock Text="Use a custom source for mod information"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontSize="12"
                                       Foreground="{DynamicResource Brush.TextSecondary}"/>
                        </StackPanel>
                        <ToggleSwitch Grid.Column="1"
                                      VerticalAlignment="Center"
                                      IsChecked="{Binding UseCustomModlinks}"/>
                    </Grid>

                    <!-- Custom Modlinks URL -->
                    <TextBox IsVisible="{Binding UseCustomModlinks}"
                             Text="{Binding CustomModlinksUri}"
                             Watermark="https://example.com/modlinks.xml"
                             HorizontalAlignment="Stretch"/>

                    <!-- GitHub Mirror -->
                    <Grid ColumnDefinitions="*,Auto">
                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock Text="Use GitHub Mirror"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontWeight="Medium"
                                       Foreground="{DynamicResource Brush.TextPrimary}"/>
                            <TextBlock Text="Download mods from GitHub mirror for faster speeds"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontSize="12"
                                       Foreground="{DynamicResource Brush.TextSecondary}"/>
                        </StackPanel>
                        <ToggleSwitch Grid.Column="1"
                                      VerticalAlignment="Center"
                                      IsChecked="{Binding UseGithubMirror}"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Maintenance -->
            <Border Classes="card">
                <StackPanel Spacing="24">
                    <TextBlock Text="Maintenance"
                               FontFamily="{DynamicResource UIFont}"
                               FontSize="18"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource Brush.TextPrimary}"/>

                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
                        <StackPanel Grid.Column="0" Grid.Row="0" Spacing="4">
                            <TextBlock Text="Open Config Folder"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontWeight="Medium"
                                       Foreground="{DynamicResource Brush.TextPrimary}"/>
                            <TextBlock Text="Open the settings and cache directory"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontSize="12"
                                       Foreground="{DynamicResource Brush.TextSecondary}"/>
                        </StackPanel>
                        <Button Grid.Column="1" Grid.Row="0"
                                Classes="secondary"
                                Content="Open"
                                MinWidth="120"
                                Command="{Binding OpenConfigFolder}"/>

                        <StackPanel Grid.Column="0" Grid.Row="1" Spacing="4" Margin="0,12,0,0">
                            <TextBlock Text="Clear Cache"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontWeight="Medium"
                                       Foreground="{DynamicResource Brush.TextPrimary}"/>
                            <TextBlock Text="Free up disk space used by downloads"
                                       FontFamily="{DynamicResource UIFont}"
                                       FontSize="12"
                                       Foreground="{DynamicResource Brush.TextSecondary}"/>
                        </StackPanel>
                        <Button Grid.Column="1" Grid.Row="1"
                                Classes="secondary"
                                Content="Clear"
                                MinWidth="120"
                            Margin="0,12,0,0"
                                Command="{Binding ClearCache}"/>
                    </Grid>
                </StackPanel>
            </Border>

    <!-- Action Buttons -->
    <StackPanel Orientation="Horizontal"
        HorizontalAlignment="Center"
        VerticalAlignment="Center"
        Spacing="12">
      <Button Classes="secondary"
          Content="Reset to Defaults"
          MinWidth="160"
          Width="160"
          Height="44"
          FontFamily="{DynamicResource UIFont}"
          FontWeight="Medium"
          FontSize="13"
          HorizontalContentAlignment="Center"
          VerticalContentAlignment="Center"
          Command="{Binding ResetSettings}"
          ToolTip.Tip="Reset all settings to their default values"/>
      <Button Classes="primary"
          Content="Save Settings"
          MinWidth="160"
          Width="160"
          Height="44"
          FontFamily="{DynamicResource UIFont}"
          FontWeight="Medium"
          FontSize="13"
          HorizontalContentAlignment="Center"
          VerticalContentAlignment="Center"
          Command="{Binding SaveSettings}"/>
    </StackPanel>
        </StackPanel>
    </ScrollViewer>
</views:View>

